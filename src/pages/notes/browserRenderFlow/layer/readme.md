# 分层（Layer）

这一层是现代浏览器（以Chrome为例）做的优化，不是所有浏览器的渲染流程中都存在的。这个一定要和css的z-index属性区分开  

分层个人感觉有点像目前前端做的组件的概念，是浏览器将Layout树中的元素，按照一定算法将一些不同的元素组合分到同一层次中，当元素发生变化时，只会影响同层元素的后续处理流程。  
以现在的情况看，浏览器目前不会分太多层。  

以Chrome为例，分层信息可以在调试工具的Layer选项卡中看到，如下图：  

![分层示例](/src/assets/browserRender/layer_demo.jpg)

我们可以看到示例中的网页被分成了三层，一层基础的document层，一层是网页主要内容区一个class名为article的元素一层，还有就是滚动条（#537）一层  

如果在浏览器的调试工具中看不到这个选项卡，请点击调试工作右侧关闭按钮旁边的三个点，里面的More tools(更多工具)，里面能找到，都没有，请升级浏览器  

我们可以通过一些CSS属性影响分层的决策，主要是一些和堆叠上下文相关的属性（z-index、opacity、transfrom、will-change等）。但是也只是影响，具体影响程度如何，结果如何，这取决于浏览器自身的优化策略，可能和浏览器不同、版本不同、操作系统不同、硬件条件不同可能都有不同。

其中可以特别了解下**will-change**,这个属性是告诉浏览器某个元素的某些属性会在接下来经常变化，那么浏览器就有可能会为此做出分层优化，可以提高渲染效率。  
但是慎用，因为浏览器每分一层，可以看到分层的detail中，每一层都占用了不小的内存空间，通常会原超过元素本身需要的内存空间，当分层过多，会导致内存占用过大等问题，得不偿失

## 堆叠上下文

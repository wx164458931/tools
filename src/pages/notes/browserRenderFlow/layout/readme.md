# 布局（Layout）

layout是拿到DOMtree和CSSOMTree经过样式计算（computed Style）之后得到带有最终样式的DOM树进行一些列计算的过程，它经过一些列过程得到dom树中每个节点的位置、宽高等各种信息。然后生成Layout树。这一步主要是得到当前需要渲染的内容的几何信息。  

Layout树和DOM树类似，但是不完全一样。例如(下列列表没有完全列完，只列了一些我知道的):  

- Layout树中不包含display:none等不参与布局的dom元素
- w3c标准中，块盒不能直接包含文本，只能行盒包含，所以对块盒直接包容的内容，浏览器会自动的给块盒内的内容增加一个匿名行盒来作为容器包容
- w3c标准中，行盒和快盒不能相邻，所以对于块盒相邻的行盒，会生成匿名块盒作为容器包容
- before\after等伪元素，这些伪元素在dom树中不存，但在生成的layout树中却存在
- 滚动条
- layout树中的对象是JS无法访问的，它的元素不是DOM对象。但是可以通过JS我们拿到一些Layout树的属性，例如元素的clientHeight等
- 还有其他等等

这其中比较需要注意的是对元素的位置、层次等信息的计算。要了解这些信息，就得了解CSS的视觉格式化模型

这儿特别说明一点，**行级元素**、**块级元素**等说法过时且错误。原因是**元素**是**HTML**中的概率。  
但是**行**、**块**包括**弹性**等属性是由**CSS属性**决定的，它们其实和HTML并没有任何关系，只和CSS的盒模型有关，HTML只提供语义化标签。  
当我们使用**行级元素**、**块级元素**等说法的时候，天然包含一种含义，既某种元素的盒属性是HTML标签决定的，这个HTML标签天然就是某个盒模型属性，但实际上不是，他们的默认的盒模型属性是由浏览器默认样式表提供的，可以被用户自定义的样式表修改。  
所以更准确的说法是**行盒**、**块盒**等直接描述其CSS盒属性的说法，剥离其HTML的关系

## 视觉格式化模型

### 包含块

### BFC

### FFC
